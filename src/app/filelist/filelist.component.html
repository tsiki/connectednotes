<style>
  #icon-menu > * {
    align-items: stretch;
    flex-direction: column;
    width: 40px;
  }

  #note-list-container ol {
    align-items: stretch;
    display: flex;
    flex-direction: column;
    list-style-type: none;
    padding: 0;
  }

  .tag-group-note.note-link {
    display: none;
  }

  .expanded .tag-group-note.note-link {
    display: flex;
    padding-left: 30px;
    background-color: var(--primary-background-color);
  }

  .tag-group-link {
    padding-left: 0;
  }

  .tag-group-link,
  .note-link {
    cursor: pointer;
    color: var(--primary-text-color);
    display: flex;
    font-weight: 400;
    width: 100%;
  }

  button {
    outline: none;
  }

  #context-menu {
    position: absolute;
  }

  #context-menu > mat-card {
    padding: 0;
  }

  .context-menu-button {
    width: 100%;
  }

  .expand-icon {
    transform: rotate(-90deg);
  }

  .expanded .expand-icon {
    transform: initial;
  }

  #new-title-input {
    padding: 0 16px;
  }

  .unsaved-marker {
    position: sticky;
    right: 0;
  }

  .mat-button-toggle-checked {
    background-color: var(--selected-note-color);
  }

  .mat-button-toggle-checked .unsaved-marker {
    background-color: var(--selected-note-color);
  }

  .unsaved-marker {
    background-color: var(--low-contrast-background-color);
  }

  .note-link:hover .unsaved-marker {
    background-color: initial;
  }

</style>

<div id="note-list-container">
  <span *ngFor="let tagGroup of tagGroups">
    <button class="tag-group-link"
            (click)="toggleTagGroup($event)"
            mat-button>
        <mat-icon class="expand-icon">expand_more</mat-icon>
      {{ tagGroup.tag }}
    </button>

    <ng-container *ngFor="let noteId of tagGroup.noteIds">
      <button *ngIf="noteId !== noteToBeRenamed"
              [class.mat-button-toggle-checked]="selectedNoteId===noteId"
              class="note-link tag-group-note"
              (click)="openNote(noteId)"
              (contextmenu)="onRightClick($event, noteId)"
              mat-button>
        <span>{{ noteService.getNote(noteId).title }}</span>
        <span class="unsaved-marker" *ngIf="unsavedNotes.has(noteId)">*</span>
      </button>
    </ng-container>
  </span>

  <span *ngFor="let note of notes">
    <button [class.mat-button-toggle-checked]="selectedNoteId==note.id"
            class="note-link"
            *ngIf="note.id !== noteToBeRenamed"
            (click)="openNote(note.id)"
            (contextmenu)="onRightClick($event, note.id)"
            mat-button>
      <span>{{ note.title }}</span><span class="unsaved-marker" *ngIf="unsavedNotes.has(note.id)">*</span>
    </button>
    <mat-form-field id="new-title-input" *ngIf="note.id === noteToBeRenamed">
      <input matInput #titleRenameInput [value]="note.title" (keyup.enter)="executeRename(note.id, $event.target.value)">
    </mat-form-field>
  </span>
</div>

<div id="context-menu" #contextMenu [ngStyle]="{ left: contextMenuX, top: contextMenuY, zIndex: 100 }" *ngIf="showContextMenu">
  <mat-card>
    <mat-list-item><button class="context-menu-button" mat-button (click)="openNoteRenameInput()">Rename</button></mat-list-item>
    <mat-list-item><button class="context-menu-button" mat-button (click)="deleteNote()">Delete</button></mat-list-item>
  </mat-card>
</div>
